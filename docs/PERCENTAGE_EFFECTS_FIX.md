 # è£…å¤‡ç™¾åˆ†æ¯”æ•ˆæœä¿®å¤

## ğŸ” é—®é¢˜æè¿°

ç”¨æˆ·å‘ç°è£…å¤‡çš„ç™¾åˆ†æ¯”åŠ æˆæ²¡æœ‰ç”Ÿæ•ˆï¼Œä¾‹å¦‚ï¼š
- `physicalAttack: { type: "percent", value: 5 }` æ²¡æœ‰å¢åŠ ç‰©ç†æ”»å‡»
- `hp: { type: "percent", value: 30 }` æ²¡æœ‰å¢åŠ ç”Ÿå‘½å€¼

## ğŸ› åŸå› åˆ†æ

åŸæ¥çš„è®¡ç®—é€»è¾‘å­˜åœ¨é—®é¢˜ï¼š

1. **è®¡ç®—é¡ºåºé”™è¯¯**ï¼šç™¾åˆ†æ¯”æ•ˆæœåº”è¯¥åŸºäºå·²è®¡ç®—çš„å±æ€§å€¼ï¼Œä½†åŸæ¥æ˜¯åŸºäºåŸºç¡€å±æ€§
2. **åŸºç¡€å€¼ä¸º0**ï¼šå¯¹äºæ´¾ç”Ÿå±æ€§ï¼ˆå¦‚`physicalAttack`ã€`hp`ï¼‰ï¼Œå®ƒä»¬ä¸å­˜åœ¨äºåŸºç¡€å±æ€§ä¸­ï¼Œ`baseValue`ä¸º0å¯¼è‡´ç™¾åˆ†æ¯”å¤±æ•ˆ

**åŸæ¥çš„é”™è¯¯é€»è¾‘**ï¼š
```javascript
// âŒ é”™è¯¯ï¼šæ´¾ç”Ÿå±æ€§åœ¨åŸºç¡€å±æ€§ä¸­ä¸å­˜åœ¨ï¼ŒbaseValue = 0
const baseValue = finalBasicAttributes[effectKey] || 0; // physicalAttack = 0
const effectValue = calculateEffectValue(effect, baseValue, effectKey); // 0 * 5% = 0
```

## âœ… è§£å†³æ–¹æ¡ˆ

é‡æ„äº† `summonUtils.js` ä¸­çš„å±æ€§è®¡ç®—é€»è¾‘ï¼Œé‡‡ç”¨**ä¸¤é˜¶æ®µè®¡ç®—**ï¼š

### ç¬¬ä¸€é˜¶æ®µï¼šå¤„ç†åŸºç¡€å±æ€§æ•ˆæœ
```javascript
if (finalBasicAttributes.hasOwnProperty(effectKey)) {
  // åŸºç¡€å±æ€§ï¼šç«‹å³è®¡ç®—å¹¶åº”ç”¨
  const baseValue = finalBasicAttributes[effectKey] || 0;
  const effectValue = calculateEffectValue(effect, baseValue, effectKey);
  finalBasicAttributes[effectKey] += effectValue;
} else {
  // æ´¾ç”Ÿå±æ€§ï¼šå­˜å‚¨æ•ˆæœé…ç½®ï¼Œå¾…ç¬¬äºŒé˜¶æ®µå¤„ç†
  derivedAttributeEffects[effectKey].push(effect);
}
```

### ç¬¬äºŒé˜¶æ®µï¼šå¤„ç†æ´¾ç”Ÿå±æ€§æ•ˆæœ
```javascript
// é¦–å…ˆåŸºäºåŸºç¡€å±æ€§è®¡ç®—æ´¾ç”Ÿå±æ€§çš„åŸºç¡€å€¼
let baseValue = 0;
for (const baseAttr of config.attributes) {
  baseValue += (finalBasicAttributes[baseAttr] || 0) * config.multiplier;
}

// ç„¶ååº”ç”¨è£…å¤‡å¯¹è¯¥æ´¾ç”Ÿå±æ€§çš„ç™¾åˆ†æ¯”æ•ˆæœ
if (derivedAttributeEffects[attrKey]) {
  for (const effect of derivedAttributeEffects[attrKey]) {
    const effectValue = calculateEffectValue(effect, baseValue, attrKey);
    finalValue += effectValue;
  }
}
```

## ğŸ“Š è®¡ç®—ç¤ºä¾‹

**å¬å”¤å…½åŸºç¡€å±æ€§**ï¼š
- ä½“è´¨: 20 + 5(è£…å¤‡) = 25
- åŠ›é‡: 15

**è£…å¤‡æ•ˆæœ**ï¼š
- `hp: { type: "percent", value: 30 }` (+30% ç”Ÿå‘½å€¼)
- `physicalAttack: { type: "percent", value: 5 }` (+5% ç‰©ç†æ”»å‡»)

**è®¡ç®—è¿‡ç¨‹**ï¼š

1. **ç¬¬ä¸€é˜¶æ®µ**ï¼šå¤„ç†åŸºç¡€å±æ€§
   - ä½“è´¨: 20 + 5(è£…å¤‡æ•°å€¼åŠ æˆ) = 25

2. **ç¬¬äºŒé˜¶æ®µ**ï¼šè®¡ç®—æ´¾ç”Ÿå±æ€§
   - HPåŸºç¡€å€¼: 25 Ã— 15 = 375
   - HPè£…å¤‡åŠ æˆ: 375 Ã— 30% = 112.5
   - **æœ€ç»ˆHP**: 375 + 112 = 487

   - ç‰©ç†æ”»å‡»åŸºç¡€å€¼: 15 Ã— 1 = 15  
   - ç‰©ç†æ”»å‡»è£…å¤‡åŠ æˆ: 15 Ã— 5% = 0.75
   - **æœ€ç»ˆç‰©ç†æ”»å‡»**: 15 + 0 = 15 (å‘ä¸‹å–æ•´)

## ğŸ¯ ä¿®å¤åçš„æ•ˆæœ

âœ… **ç™¾åˆ†æ¯”åŠ æˆæ­£å¸¸å·¥ä½œ**ï¼šåŸºäºå®é™…è®¡ç®—å‡ºçš„å±æ€§å€¼è¿›è¡Œç™¾åˆ†æ¯”è®¡ç®—  
âœ… **æ•°å€¼åŠ æˆæ­£å¸¸å·¥ä½œ**ï¼šç›´æ¥åŠ åˆ°å¯¹åº”å±æ€§ä¸Š  
âœ… **æ··åˆæ•ˆæœæ”¯æŒ**ï¼šåŒä¸€å±æ€§å¯ä»¥åŒæ—¶æœ‰æ•°å€¼å’Œç™¾åˆ†æ¯”åŠ æˆ  
âœ… **æ˜¾ç¤ºæ­£ç¡®**ï¼š`equipmentContributions` æ˜¾ç¤ºå®é™…ç”Ÿæ•ˆçš„æ•°å€¼

## ğŸ”§ æ–‡ä»¶ä¿®æ”¹

- `src/utils/summonUtils.js` - é‡æ„å±æ€§è®¡ç®—é€»è¾‘ï¼Œé‡‡ç”¨ä¸¤é˜¶æ®µè®¡ç®—

## ğŸ§ª æµ‹è¯•å»ºè®®

1. è£…å¤‡ä¸€ä»¶æœ‰ç™¾åˆ†æ¯”åŠ æˆçš„è£…å¤‡
2. æŸ¥çœ‹å¬å”¤å…½å±æ€§æ˜¯å¦æ­£ç¡®å¢åŠ 
3. æ£€æŸ¥è£…å¤‡è´¡çŒ®æ˜¾ç¤ºæ˜¯å¦æ˜¾ç¤ºå®é™…ç”Ÿæ•ˆå€¼
4. éªŒè¯æ•°å€¼å’Œç™¾åˆ†æ¯”æ··åˆæ•ˆæœ

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2025-01-27  
**çŠ¶æ€**: âœ… å·²ä¿®å¤